
## 索引

#### MySQL 为什么使用 B+ 树来作索引，对比 B 树它的优点和缺点是什么？

#### 唯一索引与普通索引的区别是什么？使用索引会有哪些优缺点？

#### 聚簇索引和非聚簇索引有什么区别？什么情况用聚集索引？

##### 区别

- 在`MySQL`中，是根据`B+`树的叶子节点来区分聚簇索引和非聚簇索引
- 聚簇索引的叶子节点存的是整行数据，非聚簇索引的叶子节点存储的内容是主键的值。
- 在没有覆盖索引的前提下，非聚簇索引的查询需要多扫描一棵索引树，因为需要回表





#### 简述什么是覆盖索引？

##### 概念

- 覆盖索引指的是，在使用索引查询时，需要查询的值已经在索引树上，因此可以直接提供查询结果，不需要回表。
- 由于覆盖索引可以减少树的搜索次数，显著提升查询性能，所以使用覆盖索引是一个常用的性能优化手段

##### 例子

```sql
/* id 为主键，c 为索引 */
SELECT id FROM T WHERE k BETWEEN 3 AND 5;
```

- 因为索引`k`的数据时`k+id`，包含了需要查询的值，不需要再回表，所以符合覆盖索引查询。



#### 简述什么是最左匹配原则？

##### 概念

- 最左匹配原则是指，在执行查询过程中，不需要索引的全部定义，只需要满足最左前缀，就可以利用索引来加速检测。
- 最左前缀可以是联合索引的最左`N`个字段，也可以是字符串索引的最左`M`个字符。

##### 例子

```sql
/* 联合索引，a, b, c */
SELECT * FROM T WHERE A=val1 /* A 符合最左匹配 */
SELECT * FROM T WHERE A=val1 AND B=val2 /* AB 符合最左匹配 */
SELECT * FROM T WHERE A=val1 AND C=val3 /* 该SQL会选择 A 作为索引去查询 */
SELECT * FROM T WHERE B=val1 AND C=val3 /* 没有用到索引，不符合 */

/* 假设 a 是字符串 */
SELECT * FROM T WHERE A="A%" /* 也是符合最左匹配原则的 */
```

##### 拓展

- 一个索引可以最多包含16列
- 取字符串的最左部分字符可以作为前缀索引，但是不能使用覆盖索引，因为索引查询时必须回表。



#### 假设建立联合索引 (a, b, c) 如果对字段 a 和 c 查询，会用到这个联合索引吗？

- 准确来说，查询字段`(a, c)` 的话，其中一部分字段会用到联合索引，也就是字段`a`，但`c`的部分没有使用索引。

- 从定义来说，我们说查询用到联合索引的话，一般指所有字段的查询都用到了该索引。也就是 `(a), (a,b),(a,b,c)` 这三种情况

  

#### 简述什么是索引下推？

##### 概念

索引下推是 `MySQL5.6` 引入的特性，指在索引遍历的过程中，在符合最左匹配原则情况下，对索引中包含的字段先进行判断，直接过来掉不满足条件的记录，减少回表次数。

##### 例子

```sql
/* 联合索引 (name, age) */
SELECT * FROM T WHERE name like 'A%' AND age = 10
```

- 在无索引下推的情况下，找到符合 `like A%` 的行，直接回表查主键的行记录，然后在判断 `age=10`
- 在有索引下推的情况下，先判断 `age = 10，再回表。



#### 数据库有哪些常见索引？数据库设计的范式是什么？

#### 简述一致性哈希算法的实现方式及原理

#### MySQL 的索引什么情况下会失效？

#### 数据库索引的实现原理是什么？

## 事务

#### 数据库的事务隔离级别有哪些？各有哪些优缺点？

#### 什么是数据库事务，MySQL 为什么会使用 InnoDB 作为默认选项

#### 简述脏读和幻读的发生场景，InnoDB 是如何解决幻读的？

#### 并发事务会引发哪些问题？如何解决？

## 锁

#### 简述乐观锁以及悲观锁的区别以及使用场景

#### 什么情况下会发生死锁，如何解决死锁？

#### 简述 MySQL 的间隙锁

## 应用

#### MySQL 有什么调优的方式？

#### 简述 MySQL 的主从同步机制，如果同步失败会怎么样？

#### 简述数据库中什么情况下进行分库，什么情况下进行分表？

#### 什么是 SQL 注入攻击？如何防止这类攻击？

#### MySQL 中 join 与 left join 的区别是什么？

#### 数据库查询中左外连接和内连接的区别是什么？

#### 模糊查询是如何实现的？

#### SQL优化的方案有哪些，如何定位问题并解决问题？

## 特性

#### 简述数据库中的 ACID 分别是什么？

#### MySQL 有哪些常见的存储引擎？它们的区别是什么？

#### 数据库反范式设计会出现什么问题？

#### MySQL 中 varchar 和 char 的区别是什么？

## 持久化

#### 简述 MySQL 三种日志的使用场景

#### 简述 undo log 和 redo log 的作用

#### 简述 MySQL MVCC 的实现原理

#### 数据库的读写分离的作用是什么？如何实现？

#### 简述什么是两阶段提交？



